//cmake
sudo apt-get install cmake
//boost
sudo apt-get install libboost-all-dev
//libpcap
sudo apt-get install libpcap-dev
//mysql connector
sudo apt-get install libmysqlcppconn-dev


//ipv6無効
/etc/sysctl.conf
# Disable IPv6
net.ipv6.conf.all.disable_ipv6 = 1

#ip
rasp2 = 192.168.2.254

#ssh設定
/etc/ssh/sshd_config
#ローカルを許可
ListenAddress 0.0.0.0
#NATした後のアドレスを許可
ListenAddress 172.16.163.254

#iptablesの初期化
iptables --flush
#確認
iptables --list


#転送は行わないのですべて拒否
iptables -P FORWARD DROP
#ssh用lanのすべての通信を拒否
#ssh用
iptables -A INPUT --in-interface eth1 -s 192.168.2.1 -p tcp --dport 22 -j ACCEPT
iptables -A INPUT --in-interface eth1 -s 192.168.2.1 -p tcp --sport 22 -j ACCEPT
iptables -A INPUT --in-interface eth1 -s 192.168.2.1 -p tcp --dport 3306 -j ACCEPT
iptables -A INPUT --in-interface eth1 -s 192.168.2.1 -p tcp --sport 3306 -j ACCEPT
iptables -A INPUT --in-interface eth1 -s 172.16.163.0/24 -p tcp --dport 22 -j ACCEPT
iptables -A INPUT --in-interface eth1 -s 172.16.163.0/24 -p tcp --sport 22 -j ACCEPT
iptables -A INPUT --in-interface eth1 -s 172.16.163.0/24 -p tcp --dport 3306 -j ACCEPT
iptables -A INPUT --in-interface eth1 -s 172.16.163.0/24 -p tcp --sport 3306 -j ACCEPT
#ssh以外のパケットを破棄
iptables --table filter --append INPUT --in-interface eth1 --jump DROP

iptables --table filter --append OUTPUT --in-interface eth0 --jump DROP

#設定を保存
iptables-save > /etc/iptables/rules.v4

/etc/iptables/rules.v4

-A INPUT -s 192.168.2.1 -i eth1 -p tcp -m tcp --dport 22 -j ACCEPT
-A INPUT -s 192.168.2.1 -i eth1 -p tcp -m tcp --sport 22 -j ACCEPT
-A INPUT -s 192.168.2.1 -i eth1 -p tcp -m tcp --dport 3306 -j ACCEPT
-A INPUT -s 192.168.2.1 -i eth1 -p tcp -m tcp --sport 3306 -j ACCEPT
-A INPUT -s 172.16.163.254 -i eth1 -p tcp -m tcp --dport 22 -j ACCEPT
-A INPUT -s 172.16.163.254 -i eth1 -p tcp -m tcp --sport 22 -j ACCEPT
-A INPUT -s 172.16.163.254 -i eth1 -p tcp -m tcp --dport 3306 -j ACCEPT
-A INPUT -s 172.16.163.254 -i eth1 -p tcp -m tcp --sport 3306 -j ACCEPT
-A INPUT -i eth1 -j DROP
-A OUTPUT -i eth0 -j DROP